$(document).ready(function () {

    var url = '/settings/upload-profile-pic';

    $("#bidUpload").fileapi({
        url: url,
        multiple: !1,
        autoUpload: !0,
        imageAutoOrientation: true,
        imageTransform: {
            rotate: 'auto',
            maxWidth: 400,
            maxHeight: 400,
            type: 'image/jpeg',
            quality: 0.70
        },
        elements: {
            size: ".js-size",
            active: {
                show: ".js-upload",
                hide: ".js-browse"
            },
            progress: ".js-progress"
        },
        accept: "image/*",
        headers: {
            "X-CSRF-Token": $("input[name=_token]").attr("value")
        },
        // onSelect: function (evt, data){
        //     if($.inArray(data.files[0].type,['image/jpg','image/png','image/gif','image/jpeg']) == -1 ){
        //       $('.error-help1').text('This format is not supported');
        //     }
        //     else{
        //       $('.error-help1').text('');
        //     }
        // },
        onComplete: function (a, b) {
            if ($.inArray(b.files[0].type, [
                    'image/jpg',
                    'image/png',
                    'image/gif',
                    'image/jpeg'
                ]) == -1) {
                $('.error-help1').text('This format is not supported');
            }
            else {
                $('.error-help1').text('');

                /*$('a.del-profile-pic').remove();*/

                var img = '/bids_images/' + b.result;
                /*$('.upload-image img:eq(0)').attr('src',img).remove();*/
                $('#profile-photo-submit').css('backgroundImage', "url('" + img + "')");
                /*$('.js-browse').css('margin-top', '5');
                 $('#theImg').hide();*/
                /*$('.upload-image').prepend('<img id="theImg" src="'+img+'" width="107"/>')*/
                //$('.prof-pic').find('img.theImg').attr('src', img);

                // $('.prof-pic').children('img').attr('src', img);
                // $('#theImg').show();
                //$('.upload-image').find('#theImg').attr('src',img);

                //Remove border error is added
                /*$('#profile .profile-box .comment-container .upload-image').css('border', '1px solid #fff !important');*/

                //   $('<input>').attr({
                //     type: 'hidden',
                //     name: 'file_temp_name',
                //     value: b.result,
                // }).appendTo('form.upload-profile-pic');
                $('input#field-temp-name').val('/bids_images/' + b.result);
                /*$('a.remove-profile-pic').css('display', 'block !important');*/


                document.getElementById('profile-upload-form').submit();
            }
        }

    })

    $('.remove-profile-pic').on('click', function () {
        //$('img#theImg').remove();
        $('.prof-pic').children('img').attr('src', '/assets/images/homepage/default-user.png');
        //$('form.create-bid-form').find('input[name="file_temp_name"]').attr('value','');
        $(this).hide();
    });
});
